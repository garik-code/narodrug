!function(e){SABAI.GoogleMaps=SABAI.GoogleMaps||{},SABAI.GoogleMaps.maps=SABAI.GoogleMaps.maps||{},SABAI.GoogleMaps.map=SABAI.GoogleMaps.map||function(o,a,i,t,n,r){var l,s,g,p,c,m,d,u,f,_,v=a.length,h=n.infobox_width||250,b=new InfoBox({boxClass:"sabai-googlemaps-infobox sabai-box-shadow",disableAutoPan:!0,closeBoxMargin:0,closeBoxURL:"https://www.google.com/intl/en_us/mapfiles/close.gif",infoBoxClearance:new google.maps.Size(30,30),pixelOffset:new google.maps.Size(-1*h/2,-55),alignBottom:!0,boxStyle:{width:h+"px"}}),w='<div class="sabai-googlemaps-infobox-arrow" style="left:'+(h/2-8)+'px"></div>',A=[];if((l=e(o)).length){i?(i=new google.maps.LatLng(i[0],i[1]),0!=n.force_fit_bounds&&v>0&&(f=new google.maps.LatLngBounds)):(i=v?new google.maps.LatLng(a[0].lat,a[0].lng):new google.maps.LatLng(n.default_lat||40.69847,n.default_lng||-73.95144),v>1&&(f=new google.maps.LatLngBounds));for(_ in google.maps.MapTypeId)A.push(google.maps.MapTypeId[_]);if(A.push("osm"),(s=new google.maps.Map(l.get(0),{mapTypeControl:!0,mapTypeId:-1!==e.inArray(l.data("map-type"),A)?l.data("map-type"):google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU,mapTypeIds:A},panControl:!1,zoom:t,center:i,scrollwheel:0!=n.scrollwheel,styles:SABAI.GoogleMaps.styles||[{featureType:"poi",stylers:[{visibility:"off"}]}],fullscreenControlOptions:{position:google.maps.ControlPosition.BOTTOM_LEFT}})).mapTypes.set("osm",new google.maps.ImageMapType({getTileUrl:function(e,o){return"//a.tile.openstreetmap.org/"+o+"/"+e.x+"/"+e.y+".png"},tileSize:new google.maps.Size(256,256),isPng:!0,maxZoom:19,minZoom:0,name:"OSM"})),v>0){if(0!=n.marker_clusters){var k={maxZoom:15};n.marker_cluster_imgurl&&(k.imagePath=n.marker_cluster_imgurl+"/m"),m=new MarkerClusterer(s,[],k)}for(u=0;u<v;u++){if(c=new google.maps.LatLng(a[u].lat,a[u].lng),g=new google.maps.Marker({position:c}),(a[u].icon||n.icon)&&(d||(d={},parseInt(n.marker_width)&&parseInt(n.marker_height)&&(d.size=d.scaledSize=new google.maps.Size(parseInt(n.marker_width),parseInt(n.marker_height)))),d.url=a[u].icon||n.icon,g.setIcon(d)),f&&(f.extend(c),0!=n.force_fit_bounds&&f.extend(new google.maps.LatLng(2*i.lat()-a[u].lat,2*i.lng()-a[u].lng))),google.maps.event.addListener(g,n.marker_event||"click",function(e,o){return function(i){p&&p.get("id")===e.get("id")||(m&&i.triggered&&(s.setZoom(16),m.repaint()),p&&p.setAnimation(null),i.triggered&&!i.trigger_infobox||!a[o].content?(e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1400)):(b.setContent(w+a[o].content),b.open(s,e),p=e,setTimeout(function(){var e=b.getHeight()+(n.infobox_offset||60)-l.height()/2;e>0&&s.panBy(0,-1*e)},100)),s.panTo(e.getPosition()))}}(g,u)),a[u].trigger){var y=e(a[u].trigger);if(y.length){var I=a[u].triggerEvent||"mouseover";y[I](function(e,o,a,i,t){return function(){if("change"!==i||a.val()==o)return google.maps.event.trigger(e,n.marker_event||"click",{triggered:!0,trigger_infobox:t}),!1;""===a.val()&&b.close()}}(g,u,y,I,a[u].trigger_infobox))}}g.set("id",u),m?m.addMarker(g):g.setMap(s),void 0!==n.default_marker&&n.default_marker===u&&setTimeout(function(e){return function(){google.maps.event.trigger(e,n.marker_event||"click",{init:!0})}}(g),1500)}if(n.enable_directions){var M=e(n.enable_directions);if(!M.length)return;var B=M.find(".sabai-googlemaps-directions-trigger");if(!B.length)return;var L,S,x,T=M.find(".sabai-googlemaps-directions-panel"),C=new google.maps.DirectionsService;M.find(".sabai-googlemaps-directions-panel").hide().end().find(".sabai-googlemaps-directions-input").val("").end().find(".sabai-googlemaps-directions-destination").val(0),B.click(function(i){i.preventDefault();var t=e(this),n=M.find(".sabai-googlemaps-directions-destination").val();if(""!==n&&a[n]){var r=M.find(".sabai-googlemaps-directions-input").val();r&&(b.close(),t.addClass("sabai-disabled"),L=a[n],x={origin:r,destination:new google.maps.LatLng(L.lat,L.lng),travelMode:google.maps.TravelMode[t.data("travel-mode")||"DRIVING"]},T.html("").hide(),null!=S&&(S.setMap(null),S=null),S=new google.maps.DirectionsRenderer({map:s,draggable:!0,panel:T.get(0)}),C.route(x,function(e,a){a==google.maps.DirectionsStatus.OK?(S.setDirections(e),SABAI.scrollTo(o),T.show().find("img.adp-marker").hide()):alert("No directions found"),t.removeClass("sabai-disabled")}))}})}google.maps.event.addListener(b,"closeclick",function(){p=null}),google.maps.event.addListener(b,"clusteringbegin",function(){b.close(),p=null}),f&&s.fitBounds(f)}if(n.circle&&n.circle.center&&parseInt(n.circle.draw)){var O=new google.maps.Circle({strokeColor:n.circle.stroke_color||"#99f",strokeOpacity:.8,strokeWeight:1,fillColor:n.circle.fill_color||"#99f",fillOpacity:.3,map:s,center:new google.maps.LatLng(n.circle.center[0],n.circle.center[1]),radius:n.circle.is_mile?1609.344*n.circle.radius:1e3*n.circle.radius});f||s.fitBounds(O.getBounds())}if(r){var D=e(n.update_trigger||o+"-update");if(D.length){var G,z=function(){D.prop("checked")&&r.call(s,s.getCenter(),s.getBounds(),s.getZoom())};google.maps.event.addListener(s,"dragend",function(){G=setTimeout(z,1e3)}),google.maps.event.addListener(s,"mousedown",function(){G&&clearTimeout(G)}),e.cookie&&D.prop("checked",e.cookie("sabai_googlemaps_map_update")).click(function(){e(this).prop("checked")?e.cookie("sabai_googlemaps_map_update",!0,{expires:7}):e.removeCookie("sabai_googlemaps_map_update")})}}return SABAI.GoogleMaps.maps[o]=s,s}},SABAI.Directory=SABAI.Directory||{},SABAI.Directory.googleMap=function(e,o,a,i,t,n,r){SABAI.GoogleMaps.map(e,o,i,t,n,r,a)}}(jQuery);